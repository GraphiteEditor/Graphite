macro_rules! map_enum {
	($target:expr, $enum:ident, $( ($code:expr, $variant:ident), )+ ) => {
		match $target {
			$(
				$enum::$variant => $code,
			)+
			_ => 0,
		}
	};
}

macro_rules! map {
	($target:expr, $( ($code:expr, $variant:literal), )+ ) => {
		match $target {
			$(
				$variant => $code,
			)+
			_ => 0,
		}
	};
}

// Windows Virtual keyboard binary representation
pub(crate) trait ToVKBits {
	fn to_vk_bits(&self) -> i32;
}

impl ToVKBits for winit::keyboard::NamedKey {
	fn to_vk_bits(&self) -> i32 {
		use winit::keyboard::NamedKey;
		map_enum!(
			self,
			NamedKey,
			(0x12, Alt),
			(0xA5, AltGraph),
			(0x14, CapsLock),
			(0x11, Control),
			(0x90, NumLock),
			(0x91, ScrollLock),
			(0x10, Shift),
			(0x5B, Meta),
			(0x5C, Super),
			(0x0D, Enter),
			(0x09, Tab),
			(0x20, Space),
			(0x28, ArrowDown),
			(0x25, ArrowLeft),
			(0x27, ArrowRight),
			(0x26, ArrowUp),
			(0x23, End),
			(0x24, Home),
			(0x22, PageDown),
			(0x21, PageUp),
			(0x08, Backspace),
			(0x0C, Clear),
			(0xF7, CrSel),
			(0x2E, Delete),
			(0xF9, EraseEof),
			(0xF8, ExSel),
			(0x2D, Insert),
			(0x1E, Accept),
			(0xF6, Attn),
			(0x03, Cancel),
			(0x5D, ContextMenu),
			(0x1B, Escape),
			(0x2B, Execute),
			(0x2F, Help),
			(0x13, Pause),
			(0xFA, Play),
			(0x5D, Props),
			(0x29, Select),
			(0xFB, ZoomIn),
			(0xFB, ZoomOut),
			(0x2C, PrintScreen),
			(0x5F, Standby),
			(0x1C, Convert),
			(0x18, FinalMode),
			(0x1F, ModeChange),
			(0x1D, NonConvert),
			(0xE5, Process),
			(0x15, HangulMode),
			(0x19, HanjaMode),
			(0x17, JunjaMode),
			(0x15, KanaMode),
			(0x19, KanjiMode),
			(0xB0, MediaFastForward),
			(0xB3, MediaPause),
			(0xB3, MediaPlay),
			(0xB3, MediaPlayPause),
			(0xB1, MediaRewind),
			(0xB2, MediaStop),
			(0xB0, MediaTrackNext),
			(0xB1, MediaTrackPrevious),
			(0x2A, Print),
			(0xAE, AudioVolumeDown),
			(0xAF, AudioVolumeUp),
			(0xAD, AudioVolumeMute),
			(0xB6, LaunchApplication1),
			(0xB7, LaunchApplication2),
			(0xB4, LaunchMail),
			(0xB5, LaunchMediaPlayer),
			(0xB5, LaunchMusicPlayer),
			(0xA6, BrowserBack),
			(0xAB, BrowserFavorites),
			(0xA7, BrowserForward),
			(0xAC, BrowserHome),
			(0xA8, BrowserRefresh),
			(0xAA, BrowserSearch),
			(0xA9, BrowserStop),
			(0xFB, ZoomToggle),
			(0x70, F1),
			(0x71, F2),
			(0x72, F3),
			(0x73, F4),
			(0x74, F5),
			(0x75, F6),
			(0x76, F7),
			(0x77, F8),
			(0x78, F9),
			(0x79, F10),
			(0x7A, F11),
			(0x7B, F12),
			(0x7C, F13),
			(0x7D, F14),
			(0x7E, F15),
			(0x7F, F16),
			(0x80, F17),
			(0x81, F18),
			(0x82, F19),
			(0x83, F20),
			(0x84, F21),
			(0x85, F22),
			(0x86, F23),
			(0x87, F24),
		)
	}
}

impl ToVKBits for char {
	fn to_vk_bits(&self) -> i32 {
		map!(
			self,
			(0x41, 'a'),
			(0x42, 'b'),
			(0x43, 'c'),
			(0x44, 'd'),
			(0x45, 'e'),
			(0x46, 'f'),
			(0x47, 'g'),
			(0x48, 'h'),
			(0x49, 'i'),
			(0x4a, 'j'),
			(0x4b, 'k'),
			(0x4c, 'l'),
			(0x4d, 'm'),
			(0x4e, 'n'),
			(0x4f, 'o'),
			(0x50, 'p'),
			(0x51, 'q'),
			(0x52, 'r'),
			(0x53, 's'),
			(0x54, 't'),
			(0x55, 'u'),
			(0x56, 'v'),
			(0x57, 'w'),
			(0x58, 'x'),
			(0x59, 'y'),
			(0x5a, 'z'),
			(0x41, 'A'),
			(0x42, 'B'),
			(0x43, 'C'),
			(0x44, 'D'),
			(0x45, 'E'),
			(0x46, 'F'),
			(0x47, 'G'),
			(0x48, 'H'),
			(0x49, 'I'),
			(0x4a, 'J'),
			(0x4b, 'K'),
			(0x4c, 'L'),
			(0x4d, 'M'),
			(0x4e, 'N'),
			(0x4f, 'O'),
			(0x50, 'P'),
			(0x51, 'Q'),
			(0x52, 'R'),
			(0x53, 'S'),
			(0x54, 'T'),
			(0x55, 'U'),
			(0x56, 'V'),
			(0x57, 'W'),
			(0x58, 'X'),
			(0x59, 'Y'),
			(0x5a, 'Z'),
			(0x31, '1'),
			(0x32, '2'),
			(0x33, '3'),
			(0x34, '4'),
			(0x35, '5'),
			(0x36, '6'),
			(0x37, '7'),
			(0x38, '8'),
			(0x39, '9'),
			(0x30, '0'),
			(0x31, '!'),
			(0x32, '@'),
			(0x33, '#'),
			(0x34, '$'),
			(0x35, '%'),
			(0x36, '^'),
			(0x37, '&'),
			(0x38, '*'),
			(0x39, '('),
			(0x30, ')'),
			(0xC0, '`'),
			(0xC0, '~'),
			(0xBD, '-'),
			(0xBD, '_'),
			(0xBB, '='),
			(0xBB, '+'),
			(0xDB, '['),
			(0xDB, '{'),
			(0xDD, ']'),
			(0xDD, '}'),
			(0xDC, '\\'),
			(0xDC, '|'),
			(0xBA, ';'),
			(0xBA, ':'),
			(0xBC, ','),
			(0xBC, '<'),
			(0xBE, '.'),
			(0xBE, '>'),
			(0xDE, '\''),
			(0xDE, '"'),
			(0xBF, '/'),
			(0xBF, '?'),
		)
	}
}

// Chromium dom key binary representation
pub(crate) trait ToDomBits {
	fn to_dom_bits(&self) -> i32;
}

impl ToDomBits for winit::keyboard::NamedKey {
	fn to_dom_bits(&self) -> i32 {
		use winit::keyboard::NamedKey;
		map_enum!(
			self,
			NamedKey,
			(0x00, Hyper),
			(0x85, Super),
			(0x25, Control),
			(0x32, Shift),
			(0x40, Alt),
			(0x00, Fn),
			(0x00, FnLock),
			(0x24, Enter),
			(0x09, Escape),
			(0x16, Backspace),
			(0x17, Tab),
			(0x41, Space),
			(0x42, CapsLock),
			(0x43, F1),
			(0x44, F2),
			(0x45, F3),
			(0x46, F4),
			(0x47, F5),
			(0x48, F6),
			(0x49, F7),
			(0x4a, F8),
			(0x4b, F9),
			(0x4c, F10),
			(0x5f, F11),
			(0x60, F12),
			(0x6b, PrintScreen),
			(0x4e, ScrollLock),
			(0x7f, Pause),
			(0x76, Insert),
			(0x6e, Home),
			(0x70, PageUp),
			(0x77, Delete),
			(0x73, End),
			(0x75, PageDown),
			(0x72, ArrowRight),
			(0x71, ArrowLeft),
			(0x74, ArrowDown),
			(0x6f, ArrowUp),
			(0x4d, NumLock),
			(0x87, ContextMenu),
			(0x7c, Power),
			(0xbf, F13),
			(0xc0, F14),
			(0xc1, F15),
			(0xc2, F16),
			(0xc3, F17),
			(0xc4, F18),
			(0xc5, F19),
			(0xc6, F20),
			(0xc7, F21),
			(0xc8, F22),
			(0xc9, F23),
			(0xca, F24),
			(0x8e, Open),
			(0x92, Help),
			(0x8c, Select),
			(0x89, Again),
			(0x8b, Undo),
			(0x91, Cut),
			(0x8d, Copy),
			(0x8f, Paste),
			(0x90, Find),
			(0x79, AudioVolumeMute),
			(0x7b, AudioVolumeUp),
			(0x7a, AudioVolumeDown),
			(0x65, KanaMode),
			(0x64, Convert),
			(0x66, NonConvert),
			(0x00, Props),
			(0xe9, BrightnessUp),
			(0xe8, BrightnessDown),
			(0xd7, MediaPlay),
			(0xd1, MediaPause),
			(0xaf, MediaRecord),
			(0xd8, MediaFastForward),
			(0xb0, MediaRewind),
			(0xab, MediaTrackNext),
			(0xad, MediaTrackPrevious),
			(0xae, MediaStop),
			(0xa9, Eject),
			(0xac, MediaPlayPause),
			(0xa3, LaunchMail),
			(0xe1, BrowserSearch),
			(0xb4, BrowserHome),
			(0xa6, BrowserBack),
			(0xa7, BrowserForward),
			(0x88, BrowserStop),
			(0xb5, BrowserRefresh),
			(0xa4, BrowserFavorites),
			(0xf0, MailReply),
			(0xf1, MailForward),
			(0xef, MailSend),
		)
	}
}

impl ToDomBits for char {
	fn to_dom_bits(&self) -> i32 {
		map!(
			self,
			(0x26, 'a'),
			(0x38, 'b'),
			(0x36, 'c'),
			(0x28, 'd'),
			(0x1a, 'e'),
			(0x29, 'f'),
			(0x2a, 'g'),
			(0x2b, 'h'),
			(0x1f, 'i'),
			(0x2c, 'j'),
			(0x2d, 'k'),
			(0x2e, 'l'),
			(0x3a, 'm'),
			(0x39, 'n'),
			(0x20, 'o'),
			(0x21, 'p'),
			(0x18, 'q'),
			(0x1b, 'r'),
			(0x27, 's'),
			(0x1c, 't'),
			(0x1e, 'u'),
			(0x37, 'v'),
			(0x19, 'w'),
			(0x35, 'x'),
			(0x1d, 'y'),
			(0x34, 'z'),
			(0x26, 'A'),
			(0x38, 'B'),
			(0x36, 'C'),
			(0x28, 'D'),
			(0x1a, 'E'),
			(0x29, 'F'),
			(0x2a, 'G'),
			(0x2b, 'H'),
			(0x1f, 'I'),
			(0x2c, 'J'),
			(0x2d, 'K'),
			(0x2e, 'L'),
			(0x3a, 'M'),
			(0x39, 'N'),
			(0x20, 'O'),
			(0x21, 'P'),
			(0x18, 'Q'),
			(0x1b, 'R'),
			(0x27, 'S'),
			(0x1c, 'T'),
			(0x1e, 'U'),
			(0x37, 'V'),
			(0x19, 'W'),
			(0x35, 'X'),
			(0x1d, 'Y'),
			(0x34, 'Z'),
			(0x0a, '1'),
			(0x0b, '2'),
			(0x0c, '3'),
			(0x0d, '4'),
			(0x0e, '5'),
			(0x0f, '6'),
			(0x10, '7'),
			(0x11, '8'),
			(0x12, '9'),
			(0x13, '0'),
			(0x0a, '!'),
			(0x0b, '@'),
			(0x0c, '#'),
			(0x0d, '$'),
			(0x0e, '%'),
			(0x0f, '^'),
			(0x10, '&'),
			(0x11, '*'),
			(0x12, '('),
			(0x13, ')'),
			(0x31, '`'),
			(0x31, '~'),
			(0x14, '-'),
			(0x14, '_'),
			(0x15, '='),
			(0x15, '+'),
			(0x22, '['),
			(0x22, '{'),
			(0x23, ']'),
			(0x23, '}'),
			(0x33, '\\'),
			(0x33, '|'),
			(0x2f, ';'),
			(0x2f, ':'),
			(0x3b, ','),
			(0x3b, '<'),
			(0x3c, '.'),
			(0x3c, '>'),
			(0x30, '\''),
			(0x30, '"'),
			(0x3d, '/'),
			(0x3d, '?'),
		)
	}
}
